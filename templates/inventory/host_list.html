{% extends 'base/base.html' %}
{% block page_title %}Inventory - Hosts{% endblock %}
{% block content %}
<div class="container-fluid">
  <div class="card mb-4">
    <div class="card-header bg-light d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Filtros</h5>
      {% if env_id or group_id or os_filter %}
        <a href="{% url 'host_list' %}" class="btn btn-sm btn-outline-secondary"><i class="fas fa-times"></i> Limpiar filtros</a>
      {% endif %}
    </div>
    <div class="card-body">
      <form method="get" class="form-row align-items-end" id="filterForm">
        <div class="col-md-3 mb-2">
          <label for="environment" class="font-weight-bold text-dark">Entorno</label>
          <select name="environment" id="environment" class="form-control filter-select">
            <option value="">Todos los entornos</option>
            {% for env in environments %}
              <option value="{{ env.id }}" {% if env_id|default:'' == env.id|stringformat:'s' %}selected{% endif %}>{{ env.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-3 mb-2">
          <label for="group" class="font-weight-bold text-dark">Grupo</label>
          <select name="group" id="group" class="form-control filter-select">
            <option value="">Todos los grupos</option>
            {% for group in groups %}
              <option value="{{ group.id }}" {% if group_id|default:'' == group.id|stringformat:'s' %}selected{% endif %}>{{ group.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-3 mb-2">
          <label for="operating_system" class="font-weight-bold text-dark">Sistema Operativo</label>
          <select name="operating_system" id="operating_system" class="form-control filter-select">
            <option value="">Todos los sistemas</option>
            {% for os in os_choices %}
              <option value="{{ os.0 }}" {% if os_filter == os.0 %}selected{% endif %}>{{ os.1 }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-3 mb-2">
          <button type="submit" class="btn btn-primary btn-block">Filtrar</button>
        </div>
      </form>
    </div>
  </div>

  <div class="card mt-4">
      <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
        <h5 class="m-0">Inventory - Hosts</h5>
        <a href="{% url 'host_create' %}" class="btn btn-light btn-sm"><i class="fas fa-plus"></i> Add New Host</a>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-hover table-striped">
            <thead>
              <tr>
                <th>Host Name</th>
                <th>Environment</th>
                <th>Group</th>
                <th>Operating System</th>
                <th class="text-center">Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for host in hosts %}
                <tr>
                  <td><strong class="text-primary host-name">{{ host.name }}</strong></td>
                  <td>{{ host.environment.name }}</td>
                  <td>{{ host.group.name }}</td>
                  <td>{{ host.get_operating_system_display }}</td>
                  <td class="text-center">
                    <div class="btn-group" role="group">
                      <a href="{% url 'host_detail' host.pk %}" class="btn btn-info btn-sm" title="View"><i class="fas fa-eye"></i></a>
                      <a href="{% url 'host_update' host.pk %}" class="btn btn-warning btn-sm" title="Edit"><i class="fas fa-edit"></i></a>
                      <a href="{% url 'host_delete' host.pk %}" class="btn btn-danger btn-sm" title="Delete"><i class="fas fa-trash"></i></a>
                    </div>
                  </td>
                </tr>
              {% empty %}
                <tr>
                  <td colspan="5" class="text-center">No hosts found matching the selected filters.</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
</div>

<style>
  /* Reseteo de estilos para los selectores */
  select {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
  }
  
  /* Modern Select Styling */
  .modern-select {
    appearance: none !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    width: 100% !important;
    padding: 10px 15px !important;
    font-size: 14px !important;
    font-weight: 500 !important;
    line-height: 1.3 !important;
    color: #333333 !important;
    background-color: #ffffff !important;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24'%3E%3Cpath fill='%23000000' d='M7 10l5 5 5-5H7z'/%3E%3C/svg%3E") !important;
    background-repeat: no-repeat !important;
    background-position: right 8px center !important;
    background-size: 20px !important;
    border: 2px solid #333333 !important;
    border-radius: 4px !important;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
    text-rendering: geometricPrecision !important;
    -webkit-font-smoothing: subpixel-antialiased !important;
  }
  
  .modern-select:focus {
    border-color: #007bff;
    outline: 0;
    box-shadow: 0 0 0 0.3rem rgba(0, 123, 255, 0.3);
  }
  
  .modern-select:hover {
    border-color: #000000;
    background-color: #f8f9fa;
  }
  
  /* Estilo para los textos dentro de los selectores */
  .modern-select option {
    font-weight: 500;
    padding: 10px;
    background-color: white;
    color: black;
  }
  
  /* Host name styling */
  .host-name {
    font-size: 1.1em;
    letter-spacing: 0.5px;
    color: #0056b3;
    display: inline-block;
    padding: 3px 8px;
    border-radius: 4px;
    background-color: rgba(0, 123, 255, 0.1);
    transition: all 0.2s ease;
  }
  
  .host-name:hover {
    background-color: rgba(0, 123, 255, 0.2);
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  
  /* Filter badges */
  .filter-badge {
    display: inline-block;
    padding: 0.25em 0.6em;
    font-size: 80%;
    font-weight: 700;
    line-height: 1;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 0.25rem;
    background-color: #e9ecef;
    margin-right: 0.5rem;
  }
  
  .filter-active {
    background-color: #28a745;
    color: white;
  }
  
  /* Table styling */
  .table-hover tbody tr:hover {
    background-color: rgba(0, 123, 255, 0.05);
  }
</style>
{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Filtrado automÃ¡tico al cambiar los selects
    const filterSelects = document.querySelectorAll('.filter-select');
    filterSelects.forEach(select => {
      select.addEventListener('change', function() {
        document.getElementById('filterForm').submit();
      });
    });
  });
</script>
{% endblock %}
